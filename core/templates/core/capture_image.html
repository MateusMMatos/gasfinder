<!DOCTYPE html>
<html>
<head>
    <title>Capturar Imagem</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
</head>
<body>
    <header>
        <h1>Capturar Imagem</h1>
    </header>
    <video id="video" width="640" height="480" autoplay></video>
    <button id="snap">Tirar Foto</button>
    <canvas id="canvas" width="640" height="480"></canvas>
    <form id="upload-form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="imagem" id="imagem">
        <button type="submit">Upload</button>
    </form>

    <script>
        // Acessar a câmera
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => {
                const video = document.getElementById('video');
                video.srcObject = stream;
            });

        // Capturar a imagem do vídeo
        const snap = document.getElementById('snap');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');

        snap.addEventListener('click', () => {
            context.drawImage(video, 0, 0, 640, 480);
            const dataUrl = canvas.toDataURL('image/png');
            document.getElementById('imagem').value = dataUrl;
        });
    </script>
</body>
</html>
